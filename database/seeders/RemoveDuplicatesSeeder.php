<?php

namespace Database\Seeders;

use App\Models\Movie;
use App\Models\MovieType;
use App\Models\Person;
use App\Models\Studio;
use Illuminate\Database\Seeder;
use Illuminate\Support\Facades\File;
use Illuminate\Support\Facades\Log;
use Spatie\Tags\Tag;
use Throwable;
use \JsonMachine\Items;

class RemoveDuplicatesSeeder extends Seeder
{
    public function run(): void
    {
        Log::info('RemoveDuplicatesSeeder started');

        $duplicate_product_codes = [
            "ABM-001",
            "ABM-002",
            "AND-001",
            "AND-002",
            "AND-003",
            "AND-004",
            "AND-005",
            "AND-007",
            "AND-008",
            "AND-009",
            "AND-010",
            "AND-011",
            "AND-012",
            "AOSBD-003",
            "AOSBD-016",
            "AOSBD-022",
            "AOSBD-026",
            "AOSBD-031",
            "AOSBD-033",
            "AOSBD-038",
            "AOSBD-039",
            "AOSBD-040",
            "AT-002",
            "BM-005",
            "BMJB-002",
            "BSTAR-026",
            "BSTAR-9013",
            "BUD-001",
            "BUQH-040",
            "CA-001",
            "CHA-001",
            "CHA-002",
            "CHA-003",
            "CHA-004",
            "CHA-005",
            "CHA-006",
            "CHA-008",
            "CHA-009",
            "CHA-010",
            "CHA-011",
            "CP-001",
            "CP-003",
            "CP-004",
            "CP-005",
            "CP-006",
            "CP-007",
            "CP-008",
            "CP-009",
            "CP-010",
            "CP-011",
            "CP-012",
            "CP-013",
            "CP-015",
            "CP-016",
            "CP-017",
            "CP-018",
            "CP-019",
            "CP-020",
            "CP-021",
            "CPBD-029",
            "CPBD-033",
            "CPBD-039",
            "CPSKY-281",
            "CPSKY-282",
            "DBS-01",
            "DBS-07",
            "DCG-001",
            "DCV-006",
            "DCV-010",
            "DCV-011",
            "DCV-012",
            "DCV-013",
            "DCV-015",
            "DCV-020",
            "DCV-022",
            "DCV-023",
            "DCV-024",
            "DCV-032",
            "DCV-033",
            "DCV-035",
            "DCV-040",
            "DCV-041",
            "DCV-042",
            "DCV-043",
            "DCV-045",
            "DCV-046",
            "DCV-047",
            "DCV-048",
            "DCV-049",
            "DGYU-012",
            "DIC-021",
            "DIC-022",
            "DIC-023",
            "DIC-024",
            "DIC-025",
            "DOLC-001",
            "DSTAR-008",
            "DSTAR-022",
            "DSTAR-026",
            "ＤSTAR-9085",
            "EB-005",
            "EB-006",
            "EB-008",
            "EB-010",
            "EB-011",
            "EB-012",
            "EB-014",
            "EB-015",
            "EICKB-009",
            "EMO-001",
            "EMO-002",
            "ENC-003",
            "ENC-004",
            "ENC-005",
            "ENC-006",
            "ERS-001",
            "ERS-002",
            "ERS-006",
            "ERS-007",
            "ERS-008",
            "ERS-009",
            "ERS-010",
            "FANGB-002",
            "FANGB-005",
            "FEIR-0035",
            "FEIR-0047",
            "FRD-001",
            "FRD-002",
            "FRD-003",
            "FRSM-0002",
            "FZR-001",
            "FZR-002",
            "GES-001",
            "GES-002",
            "GES-003",
            "GES-004",
            "GES-005",
            "GES-007",
            "GES-008",
            "GES-009",
            "GES-010",
            "GES-011",
            "GES-012",
            "GES-014",
            "GES-015",
            "GES-016",
            "GES-017",
            "GES-018",
            "GGG-001",
            "GGG-002",
            "GGH-001",
            "GGH-002",
            "GGH-003",
            "GJ-004",
            "GJ-005",
            "GJOS-022",
            "GJOS-032",
            "GJOS-033",
            "GOOD-001",
            "GOOD-002",
            "GOOD-003",
            "GOOD-004",
            "GOOD-005",
            "GOOD-006",
            "HCM-001",
            "HINA-001",
            "HON-001",
            "HON-007",
            "HON-009",
            "HON-010",
            "HYK-001",
            "HYK-002",
            "HYK-003",
            "HYK-004",
            "HYK-006",
            "HYK-010",
            "HYK-011",
            "HYK-012",
            "HYK-015",
            "HYK-016",
            "HYK-017",
            "HYK-018",
            "HYK-019",
            "HYK-020",
            "HYK-021",
            "HYK-022",
            "HYK-024",
            "HYK-025",
            "ID-001",
            "ID-002",
            "ID-003",
            "ID-004",
            "ID-005",
            "ID-006",
            "ID-007",
            "ID-008",
            "ID-009",
            "ID-010",
            "ID-011",
            "ID-012",
            "ID-013",
            "ID-014",
            "ID-015",
            "ID-016",
            "ID-017",
            "ID-018",
            "ID-019",
            "ID-020",
            "ID-021",
            "ID-022",
            "ID-023",
            "ID-024",
            "ID-025",
            "ID-026",
            "ID-027",
            "ID-028",
            "ID-029",
            "ID-030",
            "ID-031",
            "ID-032",
            "ID-033",
            "ID-034",
            "ID-035",
            "ID-036",
            "ID-037",
            "ID-038",
            "ID-039",
            "ID-040",
            "ID-041",
            "ID-042",
            "ID-043",
            "ID-044",
            "ID-045",
            "ID-046",
            "ID-047",
            "ID-048",
            "ID-049",
            "ID-050",
            "ID-051",
            "ID-052",
            "ID-053",
            "ID-054",
            "ID-055",
            "ID-056",
            "ID-057",
            "ID-058",
            "ID-059",
            "ID-061",
            "idol-007",
            "idol-008",
            "idol-016",
            "idol-019",
            "idol-025",
            "idol-028",
            "idol-067",
            "IFJ-009",
            "IMBD-016",
            "IMBD-024",
            "IMBD-029",
            "IMBD-039",
            "IMBD-047",
            "IMBD-048",
            "IMBD-076",
            "IMBD-078",
            "IMBD-102",
            "IMBD-114",
            "IMBD-115",
            "IMBD-124",
            "IMBD-134",
            "IMBD-182",
            "IMBD-200",
            "IMBD-215",
            "IMBD-242",
            "IMBD-308",
            "IMBD-311",
            "IMBD-314",
            "IMBD-315",
            "IMBD-316",
            "IMBD-338",
            "IMBD-339",
            "IMBD-341",
            "IMBD-343",
            "IMBD-345",
            "IMBD-347",
            "IMBD-352",
            "IMBD-358",
            "IMBD-359",
            "IMBD-361",
            "IMBD-362",
            "IMBD-364",
            "IMBD-365",
            "IMBD-367",
            "IMBD-370",
            "IMBD-373",
            "IMBD-374",
            "IMBD-376",
            "IMBD-378",
            "IMBD-379",
            "IMBD-382",
            "IMBD-383",
            "IMBD-385",
            "IMBD-386",
            "IMBD-388",
            "IMBD-390",
            "IMBD-392",
            "IMBD-393",
            "IMBD-394",
            "IMBD-397",
            "IMBD-402",
            "IMBD-407",
            "IMCA-005",
            "IMKR-001",
            "IMKR-006",
            "IMKR-009",
            "IMOF-109",
            "IMOF-121",
            "IMOF-126",
            "IMOF-146",
            "IMOF-150",
            "IMOF-155",
            "IMOG-221",
            "IMOG-250",
            "IMOG-308",
            "IMOG-309",
            "IMOL-012",
            "IMOL-014",
            "IMOL-047",
            "IMOL-065",
            "IMOL-066",
            "IMOL-072",
            "IMOL-074",
            "IMOL-077",
            "IMOL-078",
            "IMOM-178",
            "IMON-004",
            "IMON-005",
            "IMOT-004",
            "IMOT-050",
            "IMOT-052",
            "IMOT-053",
            "IMOU-002",
            "IMOU-009",
            "IMOU-011",
            "IMOU-015",
            "IMOV-003",
            "IMOV-006",
            "IMOV-013",
            "IMPM-014",
            "IMPM-016",
            "IMPM-020",
            "IMPM-022",
            "IMPM-024",
            "IMPM-026",
            "IMPM-029",
            "IMPM-030",
            "IMPM-032",
            "IMWL-026",
            "IMWL-029",
            "IMWL-042",
            "IMWL-046",
            "IMWL-053",
            "IMWL-055",
            "IMWL-058",
            "IMWL-060",
            "IMWL-064",
            "IMWL-065",
            "IMWL-074",
            "INC-001",
            "ISD-001",
            "ISD-002",
            "JAC-002",
            "JAC-003",
            "JAC-004",
            "JAC-005",
            "JAC-006",
            "JAC-007",
            "JAC-008",
            "JAC-009",
            "JAC-010",
            "JAC-012",
            "JAC-013",
            "JAC-014",
            "JAC-015",
            "JAC-016",
            "JAC-017",
            "JAC-018",
            "JAC-019",
            "JAC-020",
            "JAC-021",
            "JAC-022",
            "JAC-023",
            "JAC-024",
            "JAC-025",
            "JAC-026",
            "JAC-027",
            "JAC-028",
            "JAC-029",
            "JAC-030",
            "JAC-031",
            "JAC-032",
            "JAC-033",
            "JAC-034",
            "JAC-035",
            "JAC-036",
            "JAC-037",
            "JAC-038",
            "JD-001",
            "JD-002",
            "JD-003",
            "JKD-002",
            "JKD-003",
            "JKD-004",
            "JNT-001",
            "JNT-002",
            "JNT-003",
            "JNT-004",
            "JNT-005",
            "JNT-006",
            "JNT-007",
            "JNT-008",
            "JNT-009",
            "JNT-010",
            "JSSJ-080",
            "KAG-001",
            "KAG-002",
            "KAG-003",
            "KAG-004",
            "KAG-005",
            "KAG-006",
            "KAG-007",
            "KAG-009",
            "KAG-010",
            "KURO-001",
            "KURO-002",
            "LADY-081",
            "LADY-082",
            "LADY-083",
            "LADY-084",
            "LADY-086",
            "LADY-087",
            "LADY-088",
            "LADY-089",
            "LADY-090",
            "LADY-091",
            "LADY-093",
            "LADY-094",
            "LADY-095",
            "LADY-096",
            "LADY-097",
            "LADY-098",
            "LADY-099",
            "LADY-100",
            "LADY-101",
            "LADY-102",
            "LADY-103",
            "LADY-104",
            "LADY-105",
            "LADY-106",
            "LADY-107",
            "LCBD-00618",
            "LCBD-00660",
            "LES-003",
            "LES-004",
            "LES-005",
            "LES-006",
            "LES-007",
            "LES-008",
            "LES-009",
            "LES-010",
            "LES-011",
            "LOD-001",
            "LOD-002",
            "LPFD-201",
            "MAG-001",
            "MAG-002",
            "MAG-003",
            "MAG-004",
            "MAN-001",
            "MAN-002",
            "MAN-003",
            "MAN-007",
            "MAN-008",
            "MAN-009",
            "MAN-010",
            "MATBD-001",
            "MATDV-004",
            "MATDV-006",
            "MATDV-008",
            "MATDV-010",
            "MBD-001",
            "MBD-002",
            "MBD-005",
            "MBD-007",
            "MBD-009",
            "MBD-030",
            "MBD-040",
            "MBD-068",
            "MCD-001",
            "MCD-003",
            "MCD-004",
            "MCD-010",
            "MCST-001",
            "MCST-002",
            "mgbr-008",
            "mgbr-011",
            "mgbr-015",
            "milf-003",
            "milf-004",
            "milf-005",
            "milf-006",
            "milf-007",
            "milf-008",
            "milf-009",
            "milf-010",
            "milf-011",
            "milf-012",
            "milf-013",
            "milf-014",
            "MIST-001",
            "MIST-002",
            "MIST-003",
            "MIST-004",
            "MIST-005",
            "MIST-006",
            "MIST-007",
            "MIST-008",
            "MIST-009",
            "MIST-016",
            "MIST-017",
            "MIST-019",
            "MIST-020",
            "MIST-029",
            "MIST-034",
            "MIST-036",
            "MIST-037",
            "MIST-038",
            "MIST-039",
            "MIST-041",
            "MIST-043",
            "MIST-044",
            "MIST-045",
            "MIST-047",
            "MIST-050",
            "MIST-051",
            "MIST-054",
            "MIST-055",
            "MIST-058",
            "MIST-059",
            "MIST-060",
            "MIST-061",
            "MIST-062",
            "MIST-063",
            "MMR-123",
            "MMR-364",
            "MOON-001",
            "MXD-013",
            "MXD-014",
            "MXD-018",
            "MXD-023",
            "MXD-026",
            "MXD-027",
            "MXD-028",
            "MXD-029",
            "MXD-030",
            "MXD-031",
            "MXD-033",
            "MXD-035",
            "MXD-036",
            "NAD-001",
            "NAD-002",
            "NAD-003",
            "NAM-011",
            "NAM-012",
            "NAM-013",
            "NAM-014",
            "NAM-019",
            "NAM-020",
            "NDR-005",
            "NDR-008",
            "NMP-001",
            "NMP-002",
            "NNP-001",
            "NNP-002",
            "NNP-003",
            "NNP-004",
            "NNP-005",
            "NTR-001",
            "NTR-002",
            "NTR-004",
            "NTR-005",
            "NTR-006",
            "NTR-007",
            "NTR-009",
            "NTR-011",
            "NTR-012",
            "NTR-014",
            "NTR-015",
            "NTR-016",
            "NTR-017",
            "NTR-018",
            "NTR-019",
            "NTR-020",
            "NTR-022",
            "NTR-023",
            "NTR-024",
            "NTR-025",
            "NTR-028",
            "NTR-030",
            "NTR-031",
            "NTR-032",
            "NTR-033",
            "NTR-034",
            "NTR-035",
            "NTR-036",
            "NTR-037",
            "NTR-038",
            "NTR-039",
            "NTR-040",
            "NTR-042",
            "NTR-043",
            "NTR-044",
            "NTR-045",
            "NTR-046",
            "OLB-004",
            "OLB-014",
            "OLI-008",
            "OLI-019",
            "OPA-001",
            "ORGA-012",
            "ORGA-018",
            "ORGA-031",
            "ORGA-034",
            "ORGAB-013",
            "ORGAB-020",
            "ORGAB-028",
            "ORGDB-006",
            "ORGL-007",
            "ORGL-011",
            "ORGLB-012",
            "ORGW-003",
            "OUTN-0029",
            "PBD-001",
            "PBD-002",
            "PCH-002",
            "PCH-003",
            "PCH-004",
            "PCH-005",
            "PCH-006",
            "PEAB-018",
            "PEAB-031",
            "PEAC-005",
            "PEAC-009",
            "PEAC-066",
            "PEACH-001D",
            "PPP-001",
            "PPT-001",
            "PPT-002",
            "PPT-003",
            "PPT-005",
            "PPT-006",
            "PPT-007",
            "PPT-009",
            "PPT-012",
            "PPT-013",
            "PPT-017",
            "PPT-018",
            "PPT-019",
            "PPT-022",
            "PPT-023",
            "PPT-024",
            "PPT-025",
            "PPT-027",
            "PPT-028",
            "PPT-029",
            "PPT-030",
            "PPT-031",
            "PPT-033",
            "PPT-034",
            "PPT-038",
            "PPT-039",
            "PPT-041",
            "PPT-042",
            "PPT-046",
            "PPT-050",
            "PPT-051",
            "PPT-052",
            "PPT-053",
            "PPT-055",
            "PPT-059",
            "PPT-060",
            "PPT-062",
            "PPT-063",
            "PPT-065",
            "PPT-066",
            "PPT-067",
            "PPT-068",
            "PPT-069",
            "PPT-070",
            "PPT-071",
            "PPT-072",
            "PPT-074",
            "PPT-075",
            "PPT-076",
            "PPT-077",
            "PPT-078",
            "PPT-079",
            "PPT-080",
            "PPT-081",
            "PPT-083",
            "PPT-084",
            "PPT-085",
            "PPT-086",
            "PPT-087",
            "PPT-088",
            "PPT-089",
            "PPT-090",
            "PPT-091",
            "PPT-092",
            "PPT-093",
            "PPT-094",
            "PPT-095",
            "PPT-096",
            "PPT-097",
            "PPT-098",
            "PPT-099",
            "PPT-100",
            "PRI-001",
            "PUR-003",
            "REI-002",
            "SAD-001",
            "SAD-002",
            "SAD-003",
            "SAD-004",
            "SAD-005",
            "SAD-006",
            "SAD-008",
            "SAD-009",
            "SAD-010",
            "SAD-011",
            "SAD-012",
            "SAD-013",
            "SAD-014",
            "SAN-001",
            "SAN-002",
            "SAN-003",
            "SAN-004",
            "SAN-005",
            "SBVD-0221",
            "SBVD-0298",
            "SCP-001",
            "SCP-002",
            "SCP-003",
            "SCP-004",
            "SCP-005",
            "SCP-006",
            "SCP-007",
            "SCP-008",
            "SCP-009",
            "SCP-010",
            "SCP-011",
            "SCP-012",
            "SCP-013",
            "SCP-014",
            "SDS-023",
            "SDS-024",
            "SDS-025",
            "SDS-026",
            "SDS-027",
            "SDS-028",
            "seijun-01",
            "SGK-001",
            "SGK-002",
            "SHI-001",
            "SHI-006",
            "SIDV-002",
            "SKBK-001",
            "SKBK-002",
            "SKBK-003",
            "SKBK-004",
            "SKBK-005",
            "SKBK-006",
            "SKBK-007",
            "SKBK-008",
            "SKBK-009",
            "SKBK-010",
            "SLK-001",
            "SLK-004",
            "SLK-006",
            "SLK-007",
            "SLK-008",
            "SLK-013",
            "SLK-014",
            "SLK-015",
            "SLK-016",
            "SLK-017",
            "SM-060",
            "SM-061",
            "SM-062",
            "SM-097",
            "SM-098",
            "SM-099",
            "SM-100",
            "SMAC-020",
            "SMAC-027",
            "SMAC-043",
            "SMAC-045",
            "SMAC-048",
            "SMAC-053",
            "SMAC-054",
            "SMAC-057",
            "SMAC-058",
            "SMAC-062",
            "SN-002",
            "SNNY-004",
            "SOPA-001",
            "SPB-001",
            "SPB-002",
            "SPB-003",
            "SPB-004",
            "SRT-001",
            "SRT-002",
            "SSK-003",
            "SSK-004",
            "SSK-005",
            "SSK-006",
            "SSK-007",
            "SSK-008",
            "SSK-010",
            "SSK-011",
            "SSK-012",
            "SW-063",
            "SW-064",
            "SW-065",
            "SW-066",
            "SW-067",
            "SW-068",
            "SW-069",
            "SW-070",
            "SW-071",
            "SW-072",
            "SW-073",
            "SW-075",
            "SW-076",
            "SW-077",
            "SW-078",
            "SW-079",
            "SW-080",
            "SW-081",
            "SW-082",
            "SW-083",
            "SW-084",
            "SW-085",
            "SW-086",
            "SW-087",
            "SW-088",
            "SW-089",
            "SW-091",
            "SW-092",
            "SW-093",
            "SW-094",
            "SW-095",
            "SW-096",
            "SW-097",
            "SW-098",
            "SW-099",
            "SW-100",
            "SW-101",
            "SW-102",
            "SW-103",
            "SW-104",
            "SW-105",
            "SW-106",
            "SW-107",
            "SW-108",
            "SW-109",
            "SW-110",
            "SW-111",
            "SW-112",
            "SW-113",
            "SW-114",
            "SW-115",
            "SW-116",
            "SW-117",
            "SW-118",
            "SW-119",
            "SW-120",
            "SW-121",
            "SW-122",
            "SW-123",
            "SW-124",
            "SW-125",
            "SW-126",
            "SW-128",
            "SW-129",
            "SW-130",
            "SW-131",
            "SW-132",
            "SW-133",
            "SW-134",
            "SW-135",
            "TAP-001",
            "TASKJ-118",
            "TASKJ-122",
            "TASKJ-164",
            "TASKR-009",
            "TASKR-019",
            "TASKR-021",
            "TASKR-033",
            "TASKS-033",
            "TBOG-009",
            "TEN-001",
            "TEN-002",
            "TEN-003",
            "TEN-004",
            "TEN-005",
            "TEN-006",
            "TEN-011",
            "TEN-012",
            "TEN-013",
            "TEN-014",
            "TEN-015",
            "TEN-016",
            "TEN-017",
            "TEN-018",
            "TEN-019",
            "TEN-020",
            "TEN-021",
            "TEN-022",
            "TEN-023",
            "TEN-024",
            "TEN-025",
            "TEN-026",
            "TEN-027",
            "TEN-028",
            "TEN-029",
            "TEN-043",
            "TOKYO-001",
            "TOKYO-002",
            "TOKYO-003",
            "TOKYO-004",
            "TOKYO-005",
            "TOKYO-006",
            "TOKYO-007",
            "TOKYO-008",
            "TOKYO-009",
            "TOKYO-010",
            "TOKYO-011",
            "TOKYO-012",
            "TOKYO-013",
            "TOKYO-014",
            "TOKYO-015",
            "TOKYO-016",
            "TOKYO-017",
            "TOKYO-018",
            "TOKYO-019",
            "TOKYO-021",
            "TOKYO-022",
            "TOKYO-023",
            "TOKYO-024",
            "TOKYO-025",
            "TOKYO-026",
            "TOKYO-027",
            "TOKYO-028",
            "TOKYO-029",
            "TOKYO-030",
            "TOKYO-031",
            "TOKYO-032",
            "TOKYO-033",
            "TOKYO-034",
            "TOKYO-035",
            "TOKYO-036",
            "TOKYO-037",
            "TOKYO-038",
            "TOKYO-039",
            "TOKYO-040",
            "TSDS-42112",
            "URA-001",
            "URA-002",
            "VGD-033",
            "VGD-036",
            "VGD-038",
            "VGD-039",
            "VGD-041",
            "VGD-044",
            "VGD-045",
            "VGD-046",
            "VGD-047",
            "VGD-049",
            "VGD-051",
            "VGD-052",
            "VGD-055",
            "VGD-060",
            "VGD-065",
            "VGD-074",
            "VGD-077",
            "VGD-080",
            "VGD-085",
            "VGD-095",
            "VGD-102",
            "VGD-113",
            "VGD-120",
            "WAT-001",
            "WAT-002",
            "WAT-003",
            "WAT-004",
            "WAT-005",
            "WAT-007",
            "WAT-008",
            "WAT-010",
            "YZF-001"
        ];

        // Iterate through the list of movies
        foreach ($duplicate_product_codes as $product_code) {
            $duplicate_movies = Movie::where('product_code', '=', $product_code)->get();

            // Ensure that there are more than one movie with the same product code
            if ($duplicate_movies->count() > 1) {
                // Remove the last movie from the list
                $duplicate_movies->pop();

                // Delete the remaining movies
                foreach ($duplicate_movies as $movie) {
                    $movie->delete();
                }
            }
        }

        return;
    }
}
